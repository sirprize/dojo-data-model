<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>dojo-data-model/DataModel Test</title>
        <script type="text/javascript" src="config.js"></script>
        <script type="text/javascript" src="../vendor/dojo/dojo/dojo.js"></script>
        
        <script type="text/javascript">
            require([
                'doh',
                'dojo-data-model/test/MyModel',
                'dojo/domReady!'
            ], function(
                doh,
                MyModel
            ){
                doh.register("dojo-data-model/DataModel", [
                    {
                        name: 'deserialize()',
                        runTest: function () {
                            var model = MyModel({
                                props: { due: null }
                            });
                            
                            model.deserialize({
                                due: '2012-12-21'
                            });
                            
                            doh.assertTrue(typeof model.get('due') === 'object');
                            doh.assertTrue(model.get('due').getFullYear() === 2012);
                        }
                    },
                    {
                        name: 'serialize()',
                        runTest: function () {
                            var model = MyModel({
                                props: { due: null }
                            });
                            
                            model.set('due', new Date('2012-12-21'));
                            doh.assertTrue(model.serialize().due === '2012-12-21');
                        }
                    },
                    {
                        name: 'validate()',
                        runTest: function () {
                            var model = MyModel({
                                    props: { task: null }
                                }),
                                thrown = false
                            ;
                            
                            try {
                                model.validate();
                            } catch (e) {
                                thrown = true;
                                doh.assertTrue(e.errors && e.errors.task !== '');
                            }
                            
                            if (!thrown) {
                                doh.assertTrue(false);
                            }
                        }
                    }
                ]);

                doh.run();
            });
        </script>
    </head>
    
    <body>
    </body>
</html>
